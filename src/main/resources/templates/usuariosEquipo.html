<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head th:replace="fragments :: head (titulo='Equipo')"></head>
<body>
    <div th:replace="fragments::barra-menu (nombreUsuario=${nombreUsuario}, id=${idUsuario})"/>
    <div class="container-fluid">

        <div class="row mt-3">
            <div class="col">
                <h2 th:text="'Equipo ' + ${nombreEquipo}"></h2>
            </div>
        </div>
        <div class="row mt-3 col">
            <a th:if="${apuntado == false}" th:href="@{~/equipos/{id}/{accion}/usuario/{idUsuario} (id=${idEquipo}, accion='agregar', idUsuario=${idUsuario})}"
               class="btn btn-success" th:text="'Añadirme al equipo'"/>

            <a th:if="${apuntado == true}" th:href="@{~/equipos/{id}/{accion}/usuario/{idUsuario} (id=${idEquipo}, accion='eliminar', idUsuario=${idUsuario})}"
               class="btn btn-danger" th:text="'Eliminarme del equipo'"/>
        </div>
        <div class="row mt-3">
            <div class="col">
                <h4 th:text="'Tareas'" style="display: inline"></h4>
                <a th:if="${apuntado == true}" class="btn btn-primary" th:href="@{/equipos/{id}/usuarios/tareanueva(id=${idEquipo})}"> Nueva tarea</a>
                <p>
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th>Id</th>
                            <th>Titulo</th>
                            <th th:if="${apuntado == true}">Acción</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="tareaEquipo: ${tareasEquipo}">
                            <td th:text="${tareaEquipo.getId()}"></td>
                            <td th:text="${tareaEquipo.getTitulo()}"></td>
                            <td th:if="${apuntado == true}">
                                <a class="btn btn-primary btn-xs" th:href="@{/usuarios/{id}/tareas}"/>Editar</a>
                                <a class="btn btn-danger btn-xs" href="#" onmouseover="" style="cursor: pointer;"
                                   th:onclick="">Borrar</a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </p>
            </div>
            <div class="col">
                <h4 th:text="'Usuarios'"></h4>
                <p>
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th>Id</th>
                            <th>Nombre</th>
                            <th>E-mail</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="usuario: ${usuariosEquipo}">
                            <td th:text="${usuario.id}"></td>
                            <td th:text="${usuario.nombre}"></td>
                            <td th:text="${usuario.email}"></td>
                        </tr>
                        </tbody>
                    </table>
                </p>
            </div>
        </div>
    </div>
    <div th:replace="fragments::javascript"/>

    <script type="text/javascript">
        function del(urlBorrar) {
            if (confirm('¿Estás seguro/a de que quieres borrar la tarea?')) {
                $.ajax({
                    url: urlBorrar,
                    type: 'DELETE',
                    success: function (results) {
                        //refresh the page
                        location.reload();
                    }
                });
            }
        }
    </script>
</body>
</html>